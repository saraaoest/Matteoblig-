import numpy as np
import matplotlib.pyplot as plt

#Eksplisitt:
k = 1/1850 #dt
h = 1/30 #dx

x_0 = 0
x_n = 0
t_0 = 0

n_x = 30 
n_y = 100

u = np.zeros([n_y+1, n_x+1]) #31 * 10001 --> index max = 30 * 10001

f = [0, -0.6684497645622087, -1.1449269121603276, -1.3300114146453903, -1.2338386803868548, 
 -0.9673439401140237, -0.6983044742762994, -0.5876742973290638, -0.7284576698742724, 
 -1.108494391497068, -1.6103290378940873, -2.048605824649468, -2.232514756674193, 
 -2.0321235649424128, -1.4259372617473982, -0.5132558924636479, 0.5132558924636931,
   1.4259372617474333, 2.0321235649424314, 2.2325147566741927, 2.0486058246494525, 
   1.6103290378940647, 1.108494391497047, 0.7284576698742601, 0.5876742973290635, 
   0.6983044742763088, 0.9673439401140371, 1.2338386803868642, 1.330011414645389,
     1.1449269121603114, 0]

for x in range(n_x + 1):
    u[0][x] = f[x]

for t in range(n_y-1):
    u[t][0] = 0
    u[t][x_n + 1] = 0
    for x in range(1, n_x):
        u[t+1][x] = u[t][x] + k*((u[t][x+1] - 2*u[t][x] + u[t][x-1])/(h**2))
        
fig = plt.figure()
ax = plt.axes(projection = "3d")

x = np.linspace(0,10,n_x+1)
y = np.linspace(0,10,n_y+1)
X,Y =np.meshgrid(x,y)

ax.plot_surface(X,Y,u, rstride=1, cstride=1, cmap='viridis', edgecolor='none')
plt.show()
